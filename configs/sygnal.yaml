# Sygnal Configuration for ArmorClaw
# Matrix Push Gateway for FCM and APNS

## General settings
log:
  level: INFO
  format: "%(asctime)s - %(name)s - %(lineno)d - %(levelname)s - %(message)s"

## Database for pusher tracking
db:
  name: /data/sygnal.db

## Push Gateway HTTP Server
http:
  host: 0.0.0.0
  port: 5000
  # Bind to all interfaces for internal container networking

## FCM (Firebase Cloud Messaging) Configuration
fcm:
  # FCM Project ID
  project_id: "armorclaw-push"
  # Service account credentials file (mounted as secret)
  credentials_file: /etc/sygnal/fcm-credentials.json
  # Maximum retries for failed push
  max_retries: 3
  # API version (v1 uses OAuth2)
  api_version: "v1"

## APNS (Apple Push Notification Service) Configuration
# apns:
#   certfile: /etc/sygnal/apns_cert.pem
#   # or use token-based auth:
#   # keyfile: /etc/sygnal/apns_key.p8
#   # key_id: YOUR_KEY_ID
#   # team_id: YOUR_TEAM_ID
#   # topic: app.armorclaw.armorchat
#   sandbox: false

## Apps configuration
apps:
  # ArmorChat Android
  - id: "app.armorclaw.armorchat"
    type: "fcm"
    project_id: "armorclaw-push"
    credentials_file: /etc/sygnal/fcm-credentials.json

  # ArmorChat iOS (when available)
  # - id: "app.armorclaw.armorchat.ios"
  #   type: "apns"
  #   certfile: /etc/sygnal/apns_cert.pem
  #   topic: "app.armorclaw.armorchat"
  #   sandbox: false

## Stats and metrics
stats:
  host: 0.0.0.0
  port: 9100
  # Prometheus metrics endpoint

## Rate limiting
rate_limits:
  # Maximum notifications per second per device
  notifications_per_second: 20
  # Maximum concurrent pushes per app
  concurrent_pushes: 1000

## Timeout settings
timeouts:
  # Connect timeout in seconds
  connect: 5
  # Read timeout in seconds
  read: 15
  # Total timeout in seconds
  total: 30

## Retry settings
retry:
  # Enable retries
  enabled: true
  # Maximum retry attempts
  max_attempts: 3
  # Delay between retries (exponential backoff base)
  delay_base: 1
  # Maximum delay between retries
  max_delay: 60
