# Squid Configuration for ArmorClaw SDTW Egress Proxy
# Homepage: http://www.squid-cache.org/CacheMgr/
# Documentation: http://www.squid-cache.org/Doc/config/squid.conf/

# Network configuration
acl localnet src 172.18.0.0/24
acl localnet dst 172.18.0.10
acl localnet src 172.18.0.10/24
http_access allow localnet

# Proxy authentication
# authenticate_scheme basic
# auth_param basic *realm Squid proxy authentication *realm Basic

# Refresh patterns
# refresh_pattern ^http://
# refresh_pattern ^https://

# ACLs
# Define proxy ACLs
acl ALLOWED_IPS src 172.18.0.0/24
acl ALLOWED_IPS dst 172.18.0.10/24

# HTTP access lists
# Define source networks
http_access_allowlist localnet

# SSL bumping
# ssl_bump all

# Cache configuration
# Cache configuration for dynamic content
cache deny all

# Logging
# Access logs
cache_log stdio:///var/log/squid/cache.log

# Service definitions
http_port 3128
icp_port 3130
icp_port 3128

# ArmorClaw SDTW adapter proxy destinations
# Map SDTW platforms to proxy routes
http_proxy slack http://squid:3128:8080/slack
http_proxy discord http://squid:3128:8081/discord
http_proxy teams http://squid:3128:8082/teams
http_proxy whatsapp http://squid:3128:8083/whatsapp

# ArmorClaw bridge configuration
# Bridge will use HTTP_PROXY environment variable
cache deny all

# Security hardening
# No direct container access
max_fdescriptors 256
# No seccomp
# No privileged mode
# Read-only root filesystem

# Performance tuning
# Maximum connections
# Timeout settings